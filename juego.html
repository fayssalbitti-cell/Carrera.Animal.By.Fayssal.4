<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Carrera Animal</title>
<style>
body { margin:0; overflow:hidden; background:black; font-family:Arial }
canvas { display:block }
#hud {
  position:fixed; top:10px; left:10px;
  color:white; font-size:15px;
  background:rgba(0,0,0,.4);
  padding:8px; border-radius:8px;
}
#ui {
  position:fixed; top:10px; right:10px;
}
button { padding:6px 10px; font-size:14px }
</style>
</head>
<body>

<div id="hud"></div>
<div id="ui">
  <button onclick="cambiarAnimal()">Cambiar animal</button>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

let suelo = () => canvas.height - 90;
let gravedad = 0.7;
let velocidad = 7;
let scroll = 0;

const animales = [
  {nombre:"Pollo", tipo:"pollo", size:18, salto:20, color:"#fff2a8"},
  {nombre:"Gato", tipo:"gato", size:22, salto:18, color:"orange"},
  {nombre:"Burro", tipo:"burro", size:26, salto:17, color:"#777"},
  {nombre:"Oso", tipo:"oso", size:32, salto:16, color:"#5a3a1a"},
  {nombre:"Lobo", tipo:"lobo", size:24, salto:18, color:"#aaa"}
];

let animalIndex = 0;
let player = {};
let puntuacion = 0;
let vidas = 3;
let nivel = 1;
let bioma = "Ciudad";

function resetJugador(){
  let a = animales[animalIndex];
  player = {
    x: canvas.width * 0.2,
    y: suelo(),
    vy: 0,
    size: a.size,
    salto: a.salto,
    enSuelo:true
  };
}
resetJugador();

document.addEventListener("keydown", e=>{
  if(e.code==="Space" && player.enSuelo){
    player.vy = -player.salto;
    player.enSuelo=false;
  }
});

function cambiarAnimal(){
  animalIndex = (animalIndex+1)%animales.length;
  resetJugador();
}

function actualizarBioma(){
  if(nivel<4) bioma="Ciudad";
  else if(nivel<7) bioma="Bosque";
  else bioma="Desierto";
}

function fondo(){
  scroll -= velocidad/2;

  if(bioma==="Ciudad"){
    ctx.fillStyle="#444";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#222";
    for(let i=0;i<canvas.width;i+=120)
      ctx.fillRect(i+(scroll%120),canvas.height-240,80,240);
  }

  if(bioma==="Bosque"){
    ctx.fillStyle="#2c6";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#173";
    for(let i=0;i<canvas.width;i+=100){
      ctx.fillRect(i+(scroll%100),canvas.height-260,20,260);
      ctx.beginPath();
      ctx.arc(i+(scroll%100)+10,canvas.height-260,40,0,Math.PI*2);
      ctx.fill();
    }
  }

  if(bioma==="Desierto"){
    ctx.fillStyle="#e0c27a";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#b38b3c";
    for(let i=0;i<canvas.width;i+=140)
      ctx.fillRect(i+(scroll%140),canvas.height-160,20,160);
  }

  ctx.fillStyle="#333";
  ctx.fillRect(0,suelo(),canvas.width,canvas.height);
}

function dibujarAnimal(){
  let a = animales[animalIndex];
  ctx.fillStyle=a.color;

  // CUERPO
  ctx.fillRect(player.x-player.size,player.y-player.size,player.size*2,player.size);

  // CABEZA
  ctx.beginPath();
  ctx.arc(player.x,player.y-player.size,player.size/1.4,0,Math.PI*2);
  ctx.fill();

  // FORMAS ESPECIALES
  if(a.tipo==="pollo"){ // pico + cresta
    ctx.fillStyle="orange";
    ctx.fillRect(player.x+player.size-2,player.y-player.size-4,10,6);
    ctx.fillStyle="red";
    ctx.fillRect(player.x-3,player.y-player.size*2,6,10);
  }

  if(a.tipo==="gato"){ // orejas + cola
    ctx.fillRect(player.x-14,player.y-player.size*2,6,10);
    ctx.fillRect(player.x+8,player.y-player.size*2,6,10);
    ctx.fillRect(player.x-player.size-10,player.y-player.size+6,10,4);
  }

  if(a.tipo==="burro"){ // orejas largas
    ctx.fillRect(player.x-12,player.y-player.size*2,6,18);
    ctx.fillRect(player.x+6,player.y-player.size*2,6,18);
  }

  if(a.tipo==="oso"){ // cuerpo grande
    ctx.beginPath();
    ctx.arc(player.x-10,player.y-player.size,player.size/2,0,Math.PI*2);
    ctx.arc(player.x+10,player.y-player.size,player.size/2,0,Math.PI*2);
    ctx.fill();
  }

  if(a.tipo==="lobo"){ // hocico + cola larga
    ctx.fillRect(player.x+player.size-2,player.y-player.size,14,6);
    ctx.fillRect(player.x-player.size-18,player.y-player.size+6,18,4);
  }
}

function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  fondo();

  player.vy+=gravedad;
  player.y+=player.vy;
  if(player.y>=suelo()){
    player.y=suelo();
    player.vy=0;
    player.enSuelo=true;
  }

  dibujarAnimal();

  puntuacion++;
  if(puntuacion%500===0){
    nivel++;
    velocidad+=0.4;
    actualizarBioma();
  }

  document.getElementById("hud").innerHTML=
  `üêæ ${animales[animalIndex].nombre}<br>
   ‚≠ê ${puntuacion}<br>
   ‚ù§Ô∏è ${vidas}<br>
   üåç ${bioma}`;

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
